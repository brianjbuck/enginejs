function jsmxConstructor(){this.isJSMX=true;this.async=true;this.debug=false;this.waitDiv="JSMX_loading";this.http=http;this.onWait=_popWait;this.onWaitEnd=_killWait;this.onError=_onError}function http(e,t,n,r){var i=this.isJSMX?this:jsmx;var s=!r?"":_toQueryString(r);var o=false;try{var u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");u.onreadystatechange=function(){switch(u.readyState){case 1:if(!o){i.onWait(i.waitDiv);o=true}break;case 2:break;case 3:break;case 4:i.onWaitEnd(i.waitDiv);if(u.status==200){var e=true;try{var t=_parseResponse(u)}catch(r){i.onError(u,i,1);e=false}if(e){n(t)}}else{i.onError(u,i,2)}delete u;break}};u.open(e,_noCache(t),i.async);if(e.toLowerCase()=="post"){u.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}u.send(s)}catch(a){i.onError(u,i,3)}}function _parseResponse($$){var str=_cleanString($$.responseText);var xml=$$.responseXML;if(xml!=null&&xml.childNodes.length){return xml}if(str.indexOf("<wddxPacket")==0){return _parseWDDX(str)}try{return eval("("+str+")")}catch(e){return _parseJS(str)}}function _cleanString(e){var t=/\S/i;e=e.substring(e.search(t),e.length);var n=e.indexOf("HTTP/1");if(n>-1){e=e.substring(n,e.length);n=e.indexOf(String.fromCharCode(13,10,13,10));if(n>-1){e=e.substring(n+2,e.length)}}return e}function _parseJS(str){eval(str);var r=eval(str.split("=")[0].replace(/\s/g,""));return r}function _parseWDDX(e){var t=xmlStr2Doc(e);var n=t.getElementsByTagName("data");return _parseWDDXnode(n[0].firstChild)}function xmlStr2Doc(e){var t;if(typeof DOMParser=="undefined"){t=new ActiveXObject("Microsoft.XMLDOM");t.async="false";t.loadXML(e)}else{var n=new DOMParser;t=n.parseFromString(e,"application/xml")}return t}function _parseWDDXnode(e){var t;switch(e.tagName){case"string":t=_parseWDDXstring(e);break;case"number":t=parseFloat(e.firstChild.data);break;case"boolean":t=e.getAttribute("value");break;case"dateTime":t=Date(e.firstChild.data);break;case"array":t=_parseWDDXarray(e);break;case"struct":t=_parseWDDXstruct(e);break;case"recordset":t=_parseWDDXrecordset(e);break;case"binary":t=e.firstChild.data;break;case"char":t=_parseWDDXchar(e);break;case"null":t="";break;default:t=e.tagName;break}return t}function _parseWDDXstring(e){var t=e.childNodes;var n="";for(var r=0;r<t.length;r++){if(typeof t[r].data!="undefined")n+=t[r].data;else n+=_parseWDDXnode(t[r])}return n}function _parseWDDXchar(e){switch(e.getAttribute("code")){case"0d":return"\r";case"0c":return"\f";case"0a":return"\n";case"09":return"	"}}function _parseWDDXarray(e){var t=e.childNodes;var n=new Array;for(var r=0;r<t.length;r++){n[r]=_parseWDDXnode(t[r])}return n}function _parseWDDXstruct(e){var t=e.childNodes;var n=new Object;for(var r=0;r<t.length;r++){n[t[r].getAttribute("name").toLowerCase()]=_parseWDDXnode(t[r].childNodes[0])}return n}function _parseWDDXrecordset(e){var t=new Object;var n=e.getElementsByTagName("field");var r;var i;var s;for(var o=0;o<n.length;o++){r=n[o].childNodes;s=new Array;for(var u=0;u<r.length;u++){s[s.length]=_parseWDDXnode(r[u])}t[n[o].getAttribute("name").toLowerCase()]=s}return t}function _toQueryString(e){if(typeof e=="string"){return e}if(typeof e=="object"){if(typeof e.elements=="undefined"){return _object2queryString(e)}else{return _form2queryString(e)}}}function _object2queryString(e){var t=new Array;for(x in e){t[t.length]=_escape_utf8(x)+"="+_escape_utf8(e[x])}return t.join("&")}function _form2queryString(e){var t=new Object;var n=new Array;for(var r=0;r<e.elements.length;r++){try{elm=e.elements[r];nm=elm.name;if(nm!=""){switch(elm.type.split("-")[0]){case"select":for(var i=0;i<elm.options.length;i++){if(elm.options[i].selected){if(typeof t[nm]=="undefined"){t[nm]=new Array}t[nm][t[nm].length]=_escape_utf8(elm.options[i].value)}}break;case"radio":if(elm.checked){if(typeof t[nm]=="undefined"){t[nm]=new Array}t[nm][t[nm].length]=_escape_utf8(elm.value)}break;case"checkbox":if(elm.checked){if(typeof t[nm]=="undefined"){t[nm]=new Array}t[nm][t[nm].length]=_escape_utf8(elm.value)}break;default:if(typeof t[nm]=="undefined"){t[nm]=new Array}t[nm][t[nm].length]=_escape_utf8(elm.value);break}}}catch(s){}}for(x in t){n[n.length]=x+"="+t[x].join(",")}return n.join("&")}function _noCache(e){var t=new Array;var n=e.split("?");var r=n[0];if(n[1]){t=n[1].split("&")}t[t.length]="noCache="+(new Date).getTime();return r+"?"+t.join("&")}function _popWait(e){proc=document.getElementById(e);if(proc==null){var t=document.createElement("div");t.id=e;document.body.appendChild(t)}}function _killWait(e){proc=document.getElementById(e);if(proc!=null){document.body.removeChild(proc)}}function _onError(e,t,n){var r;switch(n){case 1:r=t.debug?e.responseText:"Parsing Error: The value returned could not be evaluated.";break;case 2:r=t.debug?e.responseText:"There was a problem retrieving the data:\n"+e.status+" : "+e.statusText;break;case 3:r="Unsupported browser detected.";return;break}if(t.debug){var i=window.open("","error");i.document.write(r);i.focus()}else{alert(r)}}function _escape_utf8(e){if(e==""||e==null){return""}e=e.toString();var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);var i=[];if(r>65536){i[0]=240|(r&1835008)>>>18;i[1]=128|(r&258048)>>>12;i[2]=128|(r&4032)>>>6;i[3]=128|r&63}else if(r>2048){i[0]=224|(r&61440)>>>12;i[1]=128|(r&4032)>>>6;i[2]=128|r&63}else if(r>128){i[0]=192|(r&1984)>>>6;i[1]=128|r&63}else{i[0]=r}if(r==10||r==13){t+="%0"+r.toString(16)}else if(i.length==1&&r>=48&&r<127&&r!=92){t+=e.charAt(n)}else{for(var s=0;s<i.length;s++){t+="%"+i[s].toString(16)}}}return t}function $(e){return document.getElementById(e)}var jsmx=new jsmxConstructor